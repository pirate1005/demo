<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Verifikasi OTP - Bandarmology</title>
    <link rel="icon" href="assets/img/logo.png" type="image/x-icon">

    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        brand: {
                            green: '#27AE60',
                            dark: '#0f0535',
                            bg: '#F9FAFB'
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        logo: ['Poppins', 'sans-serif'],
                    },
                    animation: {
                        'float': 'float 6s ease-in-out infinite',
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-20px)' },
                        }
                    }
                }
            }
        }
    </script>

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Poppins:wght@600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <style>
        /* Hapus spinner di input number */
        input[type=number]::-webkit-inner-spin-button,
        input[type=number]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
    </style>
</head>

<body class="bg-white font-sans" x-data="{ 
    isLoading: false,
    otp: ['', '', '', '', '', ''],
    timeLeft: 59,
    
    init() {
        this.startTimer();
    },

    startTimer() {
        this.timeLeft = 59;
        const timer = setInterval(() => {
            if (this.timeLeft <= 0) clearInterval(timer);
            else this.timeLeft--;
        }, 1000);
    },

    handleInput(e, index) {
        const val = e.target.value;
        if (!/^\d*$/.test(val)) {
            this.otp[index] = '';
            return;
        }
        
        if (val.length > 1) {
            this.otp[index] = val.slice(0, 1);
        } else {
            this.otp[index] = val;
        }

        if (val && index < 5) {
            this.$refs[`input${index + 1}`].focus();
        }
    },

    handleBackspace(e, index) {
        if (e.key === 'Backspace' && !this.otp[index] && index > 0) {
            this.$refs[`input${index - 1}`].focus();
        }
    },

    handlePaste(e) {
        e.preventDefault();
        const pasteData = e.clipboardData.getData('text').slice(0, 6).split('');
        pasteData.forEach((char, i) => {
            if (i < 6) this.otp[i] = char;
        });
        if (pasteData.length > 0) {
            const focusIndex = Math.min(pasteData.length, 5);
            this.$refs[`input${focusIndex}`].focus();
        }
    },

    submitOtp() {
        const code = this.otp.join('');
        if (code.length < 6) {
            Swal.fire({ icon: 'warning', text: 'Mohon lengkapi kode OTP!', confirmButtonColor: '#27AE60' });
            return;
        }

        this.isLoading = true;
        setTimeout(() => {
            this.isLoading = false;
            Swal.fire({
                icon: 'success',
                title: 'Verifikasi Berhasil!',
                text: 'Akun Anda telah aktif. Mengalihkan...',
                timer: 1500,
                showConfirmButton: false
            }).then(() => {
                // Redirect ke Dashboard Member (folder member/dashboard.html)
                // Sesuaikan path ini dengan struktur folder Anda
                window.location.href = 'member/dashboard.html'; 
            });
        }, 1500);
    }
}">

    <div class="min-h-screen flex w-full">

        <div class="hidden lg:flex w-1/2 bg-brand-dark relative items-center justify-center overflow-hidden">
            <div class="absolute inset-0 opacity-10" style="background-image: radial-gradient(#ffffff 1px, transparent 1px); background-size: 40px 40px;"></div>
            
            <div class="absolute top-[-10%] right-[-10%] w-96 h-96 bg-brand-green rounded-full mix-blend-multiply filter blur-[100px] opacity-40 animate-pulse"></div>
            <div class="absolute bottom-[-10%] left-[-10%] w-96 h-96 bg-purple-600 rounded-full mix-blend-multiply filter blur-[100px] opacity-40 animate-pulse" style="animation-delay: 2s"></div>

            <div class="relative z-10 text-center px-12">
                <div class="w-32 h-32 bg-white/10 backdrop-blur-md rounded-full flex items-center justify-center mx-auto mb-8 border border-white/20 animate-float shadow-2xl">
                    <i class="fas fa-shield-alt text-5xl text-brand-green"></i>
                </div>
                <h2 class="text-4xl font-extrabold text-white mb-4 tracking-tight">Verifikasi Keamanan</h2>
                <p class="text-gray-300 text-lg leading-relaxed">
                    Lindungi akun Anda dengan autentikasi dua faktor. Kode OTP dikirimkan untuk memastikan ini benar-benar Anda.
                </p>
                
                <div class="mt-12 flex justify-center gap-6 text-gray-400 text-sm font-medium">
                    <span class="flex items-center gap-2"><i class="fas fa-lock text-brand-green"></i> Enkripsi End-to-End</span>
                    <span class="flex items-center gap-2"><i class="fas fa-user-check text-brand-green"></i> Autentikasi Aman</span>
                </div>
            </div>
        </div>

        <div class="w-full lg:w-1/2 flex items-center justify-center p-6 relative bg-brand-bg">
            
            <div class="absolute top-0 left-0 w-64 h-64 bg-green-500/5 rounded-full blur-3xl pointer-events-none"></div>
            <div class="absolute bottom-0 right-0 w-40 h-40 bg-purple-500/5 rounded-full blur-3xl pointer-events-none"></div>

            <div class="w-full max-w-md bg-white p-8 sm:p-10 rounded-3xl shadow-xl border border-gray-100 relative z-10">
                
                <div class="text-center mb-12">
                    <a href="index.html" class="inline-block mb-8 hover:opacity-80 transition transform hover:scale-105 duration-300">
                        <img src="assets/img/logo-new.png" alt="Logo" class="h-32 w-auto mx-auto object-contain drop-shadow-sm">
                    </a>
                    <h1 class="text-2xl font-extrabold text-gray-900">Masukkan Kode OTP</h1>
                    <p class="text-gray-500 text-sm mt-2">
                        Kode 6 digit telah dikirim ke WhatsApp/Email Anda <br>
                        <span class="font-bold text-gray-800">0812-3456-****</span>
                    </p>
                </div>

                <form @submit.prevent="submitOtp">
                    
                    <div class="flex justify-center gap-2 sm:gap-3 mb-8" @paste="handlePaste">
                        <template x-for="(digit, index) in otp" :key="index">
                            <input type="number" 
                                   x-model="otp[index]"
                                   :x-ref="'input' + index"
                                   @input="handleInput($event, index)"
                                   @keydown="handleBackspace($event, index)"
                                   class="w-10 h-10 sm:w-12 sm:h-12 border-2 border-gray-200 rounded-lg text-center text-xl sm:text-2xl font-bold focus:border-brand-green focus:ring-2 focus:ring-green-100 outline-none transition-all bg-gray-50 focus:bg-white text-gray-800"
                                   maxlength="1" required>
                        </template>
                    </div>

                    <button type="submit" :disabled="isLoading"
                            class="w-full bg-brand-green text-white font-bold py-4 rounded-xl hover:bg-green-700 transition-all shadow-lg hover:shadow-green-200 hover:-translate-y-1 flex items-center justify-center gap-2 disabled:opacity-70 disabled:cursor-not-allowed">
                        <span x-show="!isLoading">Verifikasi</span>
                        <i x-show="!isLoading" class="fas fa-check-circle"></i>
                        
                        <svg x-show="isLoading" class="animate-spin h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                        </svg>
                    </button>

                </form>

                <div class="mt-8 text-center">
                    <p class="text-sm text-gray-500">
                        Tidak menerima kode? 
                        <span x-show="timeLeft > 0" class="font-bold text-gray-800" x-text="`00:${timeLeft.toString().padStart(2, '0')}`"></span>
                        <a href="#" @click.prevent="startTimer()" x-show="timeLeft <= 0" class="text-brand-green font-bold hover:underline">Kirim Ulang</a>
                    </p>
                    
                    <div class="mt-6 pt-6 border-t border-gray-100">
                        <a href="login.html" class="inline-flex items-center gap-2 text-sm font-bold text-gray-400 hover:text-brand-green transition">
                            <i class="fas fa-arrow-left"></i> Ganti Nomor / Email
                        </a>
                    </div>
                </div>

            </div>
        </div>

    </div>

</body>
</html>